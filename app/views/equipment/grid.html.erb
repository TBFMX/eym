<script language="Javascript">
    function mostrar(elem_id,botton) {
        var miDiv, mostrar;
        miDiv = document.getElementById(elem_id);
        if(miDiv.style.display == "none") {
            miDiv.style.display = "block";
            mostrar = document.getElementById(botton).childNodes[0];
            mostrar.data = "&#9650;";
        }
        else {
            miDiv.style.display = "none";
            mostrar = document.getElementById(botton).childNodes[0];
            mostrar.data = "&#9660;";
        }
    }
</script>

<div class="grid">

    <% request.original_url %>
    <div class="filtros">
    <p>año <a id="mostrar_years" href="javascript:mostrar('years','mostrar_years');">&#9660;</a>
    <% años = Equipment.all.order("year asc").collect {|p| [p.year] }.uniq %>
    (<%= años.size %>)  </p> 
    <div id ="years" style= "display:none">    
        <ul>    
            <% años.each do |añ| %>
            <li>
                <%= link_to añ, Filtro_path("array" => @array, "nuevo_n" => "year", "nuevo_v" => añ) %>
            </li>
            <%end%>
        </ul>
    </div>

    <p>color <a id="mostrar_color" href="javascript:mostrar('color','mostrar_color');">&#9660;</a>
    <% colores = Equipment.all.where_category(@cat).order("color asc").collect {|p| [ p.color ] }.uniq %>
    (<%= colores.size %>)  </p>
    <div id = "color" style= "display:none">   
        <ul>
            <% colores.each do |cl| %>            
            <li><%= link_to cl, Filtro_path("array" => @array, "nuevo_n" => "color", "nuevo_v" => cl) %></li>
            <%end%>
        </ul>
    </div>

    <p>marca <a id="mostrar_brand_id" href="javascript:mostrar('brand_id','mostrar_brand_id');">&#9660;</a>
    <% marcas = Brand.all.where(id: @marcas_a).order("name asc").collect {|p| [  p.name ,p.id] }.uniq %>
    (<%= marcas.size %>)  </p>
    <div id = "brand_id" style= "display:none">
        <ul>
            <% marcas.each do |m| %>
            <li><%= link_to m.first, Filtro_path("array" => @array, "nuevo_n" => "brand_id", "nuevo_v" => m.second) %></li>
            <%end%>
        </ul>
    </div>

    <p>paquete <a id="mostrar_package_id" href="javascript:mostrar('package_id','mostrar_package_id');">&#9660;</a>
    <% paquetes = Package.all.where(id: @paquetes_a).order("name asc").collect {|p| [ p.name ,p.id ] }.uniq %>
    (<%= paquetes.size %>)  </p>
    <div id = "package_id" style= "display:none">    
        <ul>
            <% paquetes.each do |pa| %>
            <li><%= link_to pa.first, Filtro_path("array" => @array, "nuevo_n" => "package_id", "nuevo_v" => pa.second) %></li>
            <%end%>
        </ul>
    </div>

    <p>precio <a id="mostrar_precio" href="javascript:mostrar('precio','mostrar_precio');">&#9660;</a>
    <% precio = Equipment.all.where_category(@cat).order("precio asc").collect {|p| [ p.precio, number_to_currency(p.precio) ] }.uniq %>      
    (<%= precio.size %>)  </p>
    <div id = "precio" style= "display:none">    
        <ul>
            <% precio.each do |pr| %>
            <li><%= link_to pr.first, Filtro_path("array" => @array, "nuevo_n" => "precio", "nuevo_v" => pr.first) %></li>
            <%end%>
        </ul>
    </div>

    <p>modelo <a id="mostrar_modelo" href="javascript:mostrar('modelo','mostrar_modelo');">&#9660;</a>
    <% modelo = Equipment.all.where_category(@cat).order("modelo asc").collect {|p| [ p.modelo, p.modelo ] }.uniq %>
    (<%= modelo.size %>)  </p>
    <div id = "modelo" style= "display:none">
        <ul>
            <% modelo.each do |mo| %>
            <li><%= link_to mo.first, Filtro_path("array" => @array, "nuevo_n" => "modelo", "nuevo_v" => mo.first) %></li>
            <%end%>
        </ul>
    </div>

    <p>moneda <a id="mostrar_currency_id" href="javascript:mostrar('currency_id','mostrar_currency_id');">&#9660;</a>
        <% mondedas = Currency.all.where(id: @monedas_a).order("name asc").collect {|p| [ p.name, p.id ] }.uniq %>
           (<%= mondedas.size %>)  </p>
    <div id = "currency_id" style= "display:none">
        <ul>
        <% mondedas.each do |mone| %>
            <li><%= link_to mone.first, Filtro_path("array" => @array, "nuevo_n" => "currency_id", "nuevo_v" => mone.second) %></li>
        <%end%>
        </ul>
    </div>

    <p>pais <a id="mostrar_country_id" href="javascript:mostrar('country_id','mostrar_country_id');">&#9660;</a>
    <% paises = Country.all.where(id: @paises_a).order("name asc").collect {|p| [p.name ,p.id] }.uniq %>
    (<%= paises.size %>)  </p>
    <div id = "country_id" style= "display:none">    
        <ul>
            <% paises.each do |country| %>
            <li><%= link_to country.first, Filtro_path("array" => @array, "nuevo_n" => "country_id", "nuevo_v" => country.second) %></li>
            <%end%>
        </ul>
    </div>

    <p>estado <a id="mostrar_state_id" href="javascript:mostrar('state_id','mostrar_state_id');">&#9660;</a>
    <% estados = State.all.where(id: @estados_a).order("country_id asc, name asc").collect {|p| [ p.name ,p.id ] }.uniq  %>
    (<%= estados.size %>)  </p>
    <div id = "state_id" style= "display:none">
        <ul>
            <% estados.each do |st| %>
            <li><%= link_to st.first, Filtro_path("array" => @array, "nuevo_n" => "state_id", "nuevo_v" => st.second) %></li>
            <%end%>
        </ul>
    </div>

    <p>ciudad <a id="mostrar_ciudad" href="javascript:mostrar('ciudad','mostrar_ciudad');">&#9660;</a>
    <% ciudades = Equipment.all.where_category(@cat).order("ciudad asc").collect {|p| [ p.ciudad, p.ciudad ] }.uniq %>
    (<%= ciudades.size %>)  </p>
    <div id = "ciudad" style= "display:none">
        <ul>
            <% ciudades.each do |city| %>
            <li><%= link_to city.first, Filtro_path("array" => @array, "nuevo_n" => "ciudad", "nuevo_v" => city.first) %></li>
            <%end%>
        </ul>
    </div>   
</div>


    <div class="galeria">
    <titulo><%= @titulo %></titulo> </br>
    <% @equipments.each do |equipment| %>
        <div class="equipos">
            <div class="imagenes">
                <% unless equipment.image_id.blank? %>
                    <% @images = Image.find(equipment.image_id) %>
                    <% if @images.image_url %>
                        <div class="imagen">
                            <%= link_to image_tag(@images.image_url ), equipment_path(equipment) %>
                        </div>
                    <%else %>
                        <div class="imagen">
                            <%= link_to image_tag("/data/dummy.png"), equipment_path(equipment) %>
                        </div>  
                    <% end %>
                <% else %>
                    <div class="imagen">
                        <%= link_to image_tag("/data/dummy.png"), equipment_path(equipment) %>
                    </div>  
                <% end %>      
            </div>
            <div class="datos">
                <span class="titulo"><%= link_to equipment.name, equipment_path(equipment) %></span>
                <span class="precio"><%= number_to_currency(equipment.precio) %> <%= equipment.currency.name %></span>
                <span class="detalles"><%= equipment.modelo %></span>
                <span class="detalles"><%= equipment.brand.name %></span>
            </div>
        </div>
     <% end %>                                      
    </div>   


</div>


